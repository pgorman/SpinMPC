<!DOCTYPE html>
<html lang="en-us">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>SpinMPC</title>
<style>
	body {
		background: #333;
		color: #ffbf00;
		font-family: monospace;
		font-size: 18pt;
	}
	a {
		color: #ffbf00;
		font-weight: bold;
		outline: 0;
		text-decoration: none;
	}
	a:active {
		color: #daa200;
	}
	li {
		line-height: 1.5em;
		list-style: none;
	}
	.control {
		color: #ffbf00;
		display: inline-block;
		font-size: 6rem;
		outline: 0;
		text-align: center;
		text-decoration: none;
		width: 3em;
	}
	#controls {
		text-align: center;
		vertical-align: middle;
	}
	#previous, #next {
		font-size: 2rem;
	}
	#display {
		text-align: center;
	}
	#songalbum {
		font-style: italic;
	}
	#songsearch {
		font-size: 2.25rem;
		padding-left: 1.25em;
	}
	#footer {
		font-size: 1rem;
		margin: 4rem 2rem 0 0;
		text-align: right;
	}
	.header {
		font-size: 3rem;
		margin: 1rem 2rem 0 0;
		text-align: right;
	}
	#menu {
		background: inherit;
		border: 2px solid #8c6900;
		display: none;
		text-align: right;
		padding: 1em;
		position: absolute;
		right: 2.5rem;
		top: 3.75rem;
		z-index: 99;
	}
	#playlists, #advanced {
		display: none;
	}
</style>
</head>
<body>

<p class="header"><a href="#" id="header" onclick="FocusMenu();">≡</a></p>

<div id="menu">
	<ul>
		<li><a href="#" onclick="FocusControls();"</a>Controls</a></li>
		<li><a href="#" onclick="FocusPlaylists();"</a>Playlists</a></li>
		<li><a href="#" onclick="Test();">Test</a></li>
		<li><a href="#" onclick="FocusAdvanced();">Advanced</a></li>
		<li><a href="https://github.com/pgorman/SpinMPC">About SpinMPC</a></li>
	</ul>
</div>

<div id="controls">
<p>
	<a id="previous" onclick="Previous();" href="#" class="control">|&lt;&lt;</a>
	<a id="pauseplay" onclick="PausePlay();" href="#" class="control">||</a>
	<a id="next" onclick="Next();" href="#" class="control">>>|</a>
</p>

<div id="display">
<p id="songinfo">
	<span id="songartist">Unknown Artist</span> — 
	"<span id="songtitle">Unknown Song Title</span>" — 
	<span id="songalbum">Unknown Album</span>
	<a id="songsearch" href="">?</a>
</p>
</div>
</div>

<div id="playlists">
<h2>Playlists</h2>
</div>

<div id="advanced">
<h2>Advanced</h2>
</div>

<script>
function Test() {
	fetch("/api/v1/test", {
		method: "POST",
		headers: {
			"Accept": "application/json",
			"Content-Type": "application/json"
		},
		body: JSON.stringify({
			playlist: "my cool playlist"
		})
	}).then(function(response) {
			return response.text();
	}).catch(function(err) {
		console.log(err);
	})
}

function CurrentSong() {
	fetch("/api/v1/currentsong").then(function(response) {
		return response.json();
	}).then(function(json) {
		document.getElementById("songartist").innerHTML = json.Artist;
		document.getElementById("songtitle").innerHTML = json.Title;
		document.getElementById("songalbum").innerHTML = json.Album;
		document.getElementById("songsearch").setAttribute("href", json.SearchURL);
	}).catch(function(err) {
		console.log(err);
	})
}

function FocusAdvanced() {
	var a = document.getElementById("advanced");
	var c = document.getElementById("controls");
	var m = document.getElementById("menu");
	var p = document.getElementById("playlists");
	m.style.display = "none";
	c.style.display = "none";
	p.style.display = "none";
	a.style.display = "block";
}

function FocusControls() {
	var a = document.getElementById("advanced");
	var c = document.getElementById("controls");
	var p = document.getElementById("playlists");
	var m = document.getElementById("menu");
	a.style.display = "none";
	m.style.display = "none";
	p.style.display = "none";
	c.style.display = "block";
}

function FocusMenu() {
	var m = document.getElementById("menu");
	var displayState = window.getComputedStyle(m).getPropertyValue("display");
	if (displayState == "none") {
		m.style.display = "block";
	} else {
		m.style.display = "none";
	}
}

function FocusPlaylists() {
	var a = document.getElementById("advanced");
	var c = document.getElementById("controls");
	var m = document.getElementById("menu");
	var p = document.getElementById("playlists");
	a.style.display = "none";
	m.style.display = "none";
	c.style.display = "none";
	p.style.display = "block";
}

function Next() {
	fetch("/api/v1/next").then(function(response) {
		return response.text();
	}).then(function(text) {
		CurrentSong();
	}).catch(function(err) {
		console.log(err);
	})
}

function PausePlay() {
	fetch("/api/v1/status").then(function(response) {
		return response.json();
	}).then(function(json) {
		if (json.state != "play") {
			fetch("/api/v1/play").then(function() {
				Refresh();
			}).catch(function(err) {
				console.log(err);
			})
		} else {
			fetch("/api/v1/pause").then(function() {
				Refresh();
			}).catch(function(err) {
				console.log(err);
			})
		}
	}).catch(function(err) {
		console.log(err);
	})
}

function Previous() {
	fetch("/api/v1/previous").then(function(response) {
		return response.text();
	}).then(function(text) {
		console.log(text);
	}).catch(function(err) {
		console.log(err);
	})
}

function Refresh() {
	var playglyph = ">";
	var pauseglyph = "||";
	fetch("/api/v1/status").then(function(response) {
		return response.json();
	}).then(function(json) {
		if (json.state != "play") {
			document.getElementById("pauseplay").innerHTML = playglyph;
		} else {
			document.getElementById("pauseplay").innerHTML = pauseglyph;
		}
	}).catch(function(err) {
		console.log(err);
	})
	CurrentSong();
}

setInterval(function() {
	Refresh();
}, 5000);

Refresh()
</script>

</body>